# MAX Bot - –ß–∞—Ç-–±–æ—Ç –¥–ª—è –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ MAX

–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π —á–∞—Ç-–±–æ—Ç –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã MAX —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –º–µ–Ω—é, –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å AI.

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

- [–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è](#-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker](#-–∑–∞–ø—É—Å–∫-—á–µ—Ä–µ–∑-docker)
- [–ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ](#-–∑–∞–ø—É—Å–∫-–ª–æ–∫–∞–ª—å–Ω–æ)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](#-api-–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è)

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ë–æ—Ç
- ‚úÖ **Long Polling** - –ø–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –æ—Ç MAX API —á–µ—Ä–µ–∑ long polling
- ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è** - –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –º–µ–Ω—é –Ω–∞ –æ—Å–Ω–æ–≤–µ `flow.json`
- ‚úÖ **Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã** - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ —Å callback
- ‚úÖ **–î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π** - –∑–∞—â–∏—Ç–∞ –æ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ callback –æ—Ç MAX API
- ‚úÖ **–ù–∞–≤–∏–≥–∞—Ü–∏—è "–ù–∞–∑–∞–¥"** - –∫–Ω–æ–ø–∫–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –º–µ–Ω—é
- ‚úÖ **AI –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AI Assistant –¥–ª—è –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- ‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (SQLite/PostgreSQL)
- ‚úÖ **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã** - —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### AI Assistant
- ‚úÖ **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ FAQ** - –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º ML –º–æ–¥–µ–ª–µ–π
- ‚úÖ **–ü–æ–∏—Å–∫ –∫–æ–º–ø–∞–Ω–∏–π** - –ø–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∫–æ–º–ø–∞–Ω–∏–π —Å –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏
- ‚úÖ **–ü–æ–∏—Å–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤** - –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∏ —É—Å–ª—É–≥
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Yandex GPT** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ YandexGPT
- ‚úÖ **PostgreSQL + pgvector** - –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
- ‚úÖ **FastAPI** - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π REST API

## üì¶ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –î–ª—è MAX Bot
- **Python 3.12+**
- **Docker –∏ Docker Compose** (–¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ)
- **MAX API Token** - –ø–æ–ª—É—á–∏—Ç–µ –Ω–∞ https://dev.max.ru
- **SQLite** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –∏–ª–∏ **PostgreSQL**

### –î–ª—è AI Assistant (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **PostgreSQL 15+ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º pgvector** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
- **Yandex Cloud API Key** - –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å YandexGPT (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone <repository-url>
cd max-bot
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–º–µ—Ä–∞:

```bash
# MAX API Configuration
MAX_API_TOKEN=your_max_api_token_here
MAX_API_URL=https://platform-api.max.ru

# AI Assistant Configuration (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
AI_API_URL=http://ai:8000
AI_API_TOKEN=your_ai_api_token_here

# Database Configuration (–¥–ª—è –±–æ—Ç–∞)
DATABASE_URL=sqlite://data/db.sqlite3

# AI Assistant Database (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è AI Assistant)
POSTGRES_HOST=psql
POSTGRES_PORT=5432
POSTGRES_USER=aidb-owner
POSTGRES_PASSWORD=your_postgres_password
POSTGRES_DB=aidb

# Yandex Cloud (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è AI Assistant —Å YandexGPT)
YANDEX_API_KEY=your_yandex_api_key
YANDEX_CATALOG_ID=your_yandex_catalog_id

# Logging
LOG_LEVEL=INFO
```

### 3. –ó–∞–ø—É—Å–∫

–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –∑–∞–ø—É—Å–∫–∞:

#### –í–∞—Ä–∏–∞–Ω—Ç A: Docker (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
docker-compose up -d
```

#### –í–∞—Ä–∏–∞–Ω—Ç B: –õ–æ–∫–∞–ª—å–Ω–æ

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
python -m venv .venv
source .venv/bin/activate  # –ù–∞ Windows: .venv\Scripts\activate
pip install -r requirements.txt

# –ó–∞–ø—É—Å–∫
python main.py
```

## üê≥ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

```bash
docker build -t max-bot:latest .
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run -d \
  --name max-bot \
  -e MAX_API_TOKEN="your_token_here" \
  -v $(pwd)/data:/app/data \
  -v $(pwd)/logs:/app/logs \
  -v $(pwd)/configs:/app/configs:ro \
  --restart unless-stopped \
  max-bot:latest
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Docker Compose

#### –ó–∞–ø—É—Å–∫ —Å SQLite (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```bash
docker-compose up -d
```

#### –ó–∞–ø—É—Å–∫ —Å PostgreSQL

```bash
docker-compose --profile postgres up -d
```

#### –ó–∞–ø—É—Å–∫ —Å AI Assistant

AI Assistant –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ FAQ, –∫–æ–º–ø–∞–Ω–∏—è–º –∏ –ø—Ä–æ–¥—É–∫—Ç–∞–º:

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (–±–æ—Ç + AI Assistant + PostgreSQL)
docker-compose up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ AI Assistant
docker-compose logs -f ai

# API AI Assistant –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: http://localhost:8000
# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API: http://localhost:8000/docs
```

**–í–∞–∂–Ω–æ:** AI Assistant —Ç—Ä–µ–±—É–µ—Ç PostgreSQL —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º `pgvector`. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
1. PostgreSQL –∑–∞–ø—É—â–µ–Ω
2. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ pgvector (—Å–º. —Ä–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ AI Assistant")

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
docker-compose logs -f bot
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
docker-compose down
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
docker-compose down
docker-compose build
docker-compose up -d
```

## üíª –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
python -m venv .venv
```

### 2. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**Linux/macOS:**
```bash
source .venv/bin/activate
```

**Windows (PowerShell):**
```powershell
.venv\Scripts\Activate.ps1
```

**Windows (CMD):**
```cmd
.venv\Scripts\activate.bat
```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install --upgrade pip
pip install -r requirements.txt
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ.

–î–ª—è SQLite:
```bash
mkdir -p data
```

–î–ª—è PostgreSQL - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω –∏ —Å–æ–∑–¥–∞–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
```sql
CREATE DATABASE maxbot;
CREATE USER maxbot WITH PASSWORD 'maxbot_password';
GRANT ALL PRIVILEGES ON DATABASE maxbot TO maxbot;
```

### 5. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
python main.py
```

### 6. –û—Å—Ç–∞–Ω–æ–≤–∫–∞

–ù–∞–∂–º–∏—Ç–µ `Ctrl+C` –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–æ—Ç–∞.

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```
configs/
‚îú‚îÄ‚îÄ settings.yaml          # –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îú‚îÄ‚îÄ settings_override.yaml # –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
‚îî‚îÄ‚îÄ flow.json             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–µ–Ω—é –∏ –ø–æ—Ç–æ–∫–æ–≤
```

### settings.yaml

```yaml
# API Configuration
Max:
  api_url: "https://platform-api.max.ru"
  token: ${MAX_API_TOKEN}
  timeout: 30

# AI Configuration (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
AI:
  api_url: ${AI_API_URL}
  token: ${AI_API_TOKEN}
  timeout: 10

# Database
Database:
  url: ${DATABASE_URL:sqlite://data/db.sqlite3}

# Logging
Logging:
  level: ${LOG_LEVEL:INFO}
```

### flow.json

–§–∞–π–ª `flow.json` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –º–µ–Ω—é –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –±–æ—Ç–∞:

```json
{
  "flows": [
    {
      "name": "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é",
      "type": "extended_static",
      "content": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!",
      "buttons": {
        "keyboard": [
          {"name": "–ö–Ω–æ–ø–∫–∞ 1"},
          {"name": "–ö–Ω–æ–ø–∫–∞ 2"}
        ]
      },
      "flows": [
        {
          "name": "–ö–Ω–æ–ø–∫–∞ 1",
          "type": "static",
          "content": "–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–Ω–æ–ø–∫–µ 1"
        }
      ]
    }
  ]
}
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
max-bot/
‚îú‚îÄ‚îÄ main.py                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ MAX Bot
‚îú‚îÄ‚îÄ requirements.txt           # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ Dockerfile                 # Docker –æ–±—Ä–∞–∑ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ docker-compose.yml         # Docker Compose (–±–æ—Ç + AI + PostgreSQL)
‚îú‚îÄ‚îÄ .dockerignore              # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è Docker
‚îÇ
‚îú‚îÄ‚îÄ common/                    # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ logger.py              # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ utils.py               # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ
‚îú‚îÄ‚îÄ configs/                   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ settings.yaml          # –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ flow.json              # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–µ–Ω—é
‚îÇ
‚îú‚îÄ‚îÄ core/                      # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ bot.py                 # –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ max_client.py          # MAX API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ handlers.py            # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ callbacks.py           # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ callback
‚îÇ   ‚îú‚îÄ‚îÄ keyboard.py            # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä
‚îÇ   ‚îú‚îÄ‚îÄ base.py                # –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py             # Pydantic —Å—Ö–µ–º—ã
‚îÇ   ‚îî‚îÄ‚îÄ utils.py               # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ database/                  # –†–∞–±–æ—Ç–∞ —Å –ë–î –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ crud.py                # CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # Tortoise ORM –º–æ–¥–µ–ª–∏
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py             # Database —Å—Ö–µ–º—ã
‚îÇ
‚îú‚îÄ‚îÄ clients/                   # –í–Ω–µ—à–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ ai/                    # AI –∫–ª–∏–µ–Ω—Ç
‚îÇ       ‚îî‚îÄ‚îÄ client.py          # HTTP –∫–ª–∏–µ–Ω—Ç –¥–ª—è AI Assistant
‚îÇ
‚îú‚îÄ‚îÄ ai-assistant/              # AI Assistant –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
‚îÇ   ‚îú‚îÄ‚îÄ main.py                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt       # Python –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ AI
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile             # Docker –æ–±—Ä–∞–∑ AI
‚îÇ   ‚îú‚îÄ‚îÄ alembic.ini            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ api/                   # REST API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ faq.py             # CRUD –¥–ª—è FAQ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search.py          # –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ companies.py       # API –∫–æ–º–ø–∞–Ω–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ products.py        # API –ø—Ä–æ–¥—É–∫—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ flow_manager.py    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–∞–º–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ database/              # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö AI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py          # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ session.py         # –°–µ—Å—Å–∏–∏ –ë–î
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/              # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ faq_service.py     # –°–µ—Ä–≤–∏—Å FAQ
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ utils/                 # –£—Ç–∏–ª–∏—Ç—ã AI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ search_utils.py    # –ü–æ–∏—Å–∫–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ text_utils.py      # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.py          # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ alembic/               # –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ versions/          # –í–µ—Ä—Å–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ scripts/               # –°–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ import_faq_to_sqlalchemy.py  # –ò–º–ø–æ—Ä—Ç FAQ
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ data_holder/           # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ faq.txt            # –ë–∞–∑–∞ FAQ (—Ç–µ–∫—Å—Ç)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ companies_db.json  # –ë–∞–∑–∞ –∫–æ–º–ø–∞–Ω–∏–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ products_db.json   # –ë–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ models.py              # Pydantic –º–æ–¥–µ–ª–∏ API
‚îÇ
‚îî‚îÄ‚îÄ data/                      # –î–∞–Ω–Ω—ã–µ
    ‚îú‚îÄ‚îÄ db.sqlite3             # SQLite –±–∞–∑–∞ –±–æ—Ç–∞
    ‚îî‚îÄ‚îÄ pgdata/                # PostgreSQL –¥–∞–Ω–Ω—ã–µ AI
```

## üîå API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### MAX API

–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MAX Platform API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:

- **GET /updates** - Long polling –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **POST /messages** - –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- **PUT /messages/{message_id}** - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- **DELETE /messages/{message_id}** - –£–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: https://dev.max.ru/docs-api

### AI Integration (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω AI —Å–µ—Ä–≤–µ—Ä, –±–æ—Ç –º–æ–∂–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```bash
POST /api/v1/chat
Content-Type: application/json

{
  "message": "–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
  "context": {}
}
```

## ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ AI Assistant

AI Assistant - —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π FastAPI –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ AI Assistant

```
ai-assistant/
‚îú‚îÄ‚îÄ api/              # REST API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ faq.py        # CRUD –¥–ª—è FAQ
‚îÇ   ‚îú‚îÄ‚îÄ search.py     # –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
‚îÇ   ‚îú‚îÄ‚îÄ companies.py  # API –∫–æ–º–ø–∞–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ products.py   # API –ø—Ä–æ–¥—É–∫—Ç–æ–≤
‚îú‚îÄ‚îÄ database/         # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ services/         # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ utils/            # –£—Ç–∏–ª–∏—Ç—ã (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏, —Ç–µ–∫—Å—Ç)
‚îú‚îÄ‚îÄ alembic/          # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ data_holder/      # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ faq.txt       # –ë–∞–∑–∞ FAQ
‚îÇ   ‚îú‚îÄ‚îÄ companies_db.json  # –ë–∞–∑–∞ –∫–æ–º–ø–∞–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ products_db.json   # –ë–∞–∑–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
‚îî‚îÄ‚îÄ main.py           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL —Å pgvector

AI Assistant —Ç—Ä–µ–±—É–µ—Ç PostgreSQL —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º pgvector –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞:

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ PostgreSQL
docker exec -it psql psql -U aidb-owner -d aidb

# 2. –°–æ–∑–¥–∞–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ pgvector
CREATE EXTENSION IF NOT EXISTS vector;

# 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É
SELECT * FROM pg_extension WHERE extname = 'vector';

# 4. –í—ã–π–¥–∏—Ç–µ
\q
```

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
# –í–æ–π–¥–∏—Ç–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä AI Assistant
docker exec -it max-ai bash

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ Alembic
cd /app
alembic upgrade head

# –í—ã–π–¥–∏—Ç–µ
exit
```

### –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö FAQ

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ FAQ –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö:

```bash
# –í–æ–π–¥–∏—Ç–µ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä AI Assistant
docker exec -it max-ai bash

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏–º–ø–æ—Ä—Ç–∞
python scripts/import_faq_to_sqlalchemy.py

# –í—ã–π–¥–∏—Ç–µ
exit
```

### API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã AI Assistant

AI Assistant –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ API:

**FAQ API:**
- `POST /faq/db` - –°–æ–∑–¥–∞—Ç—å FAQ —ç–ª–µ–º–µ–Ω—Ç
- `GET /faq/db` - –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ FAQ (—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π)
- `GET /faq/db/{id}` - –ü–æ–ª—É—á–∏—Ç—å FAQ –ø–æ ID
- `PUT /faq/db/{id}` - –û–±–Ω–æ–≤–∏—Ç—å FAQ
- `DELETE /faq/db/{id}` - –£–¥–∞–ª–∏—Ç—å FAQ
- `POST /faq/bulk_import` - –ú–∞—Å—Å–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç FAQ
- `POST /faq/recompute_embeddings` - –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏

**–ü–æ–∏—Å–∫:**
- `POST /search` - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–∏—Å–∫ (FAQ/–∫–æ–º–ø–∞–Ω–∏–∏/–ø—Ä–æ–¥—É–∫—Ç—ã)
  - `search_type`: "gpt" (–¥–ª—è FAQ —Å YandexGPT) –∏–ª–∏ "semfuz" (—Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π + fuzzy)
  - `database_name`: "faq", "cmp", "prdcts"
  - `top_k`: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 10)

**–ö–æ–º–ø–∞–Ω–∏–∏:**
- `POST /search_companies` - –ü–æ–∏—Å–∫ –∫–æ–º–ø–∞–Ω–∏–π –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º

**–ü—Ä–æ–¥—É–∫—Ç—ã:**
- `POST /search_products` - –ü–æ–∏—Å–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API:** http://localhost:8000/docs (Swagger UI)

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

```bash
# –ü–æ–∏—Å–∫ –ø–æ FAQ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º YandexGPT
curl -X POST "http://localhost:8000/search" \
  -H "Content-Type: application/json" \
  -d '{
    "search_type": "gpt",
    "database_name": "faq",
    "top_k": 5,
    "history": [
      {"role": "user", "text": "–ö–∞–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è?"}
    ]
  }'

# –ü–æ–∏—Å–∫ –∫–æ–º–ø–∞–Ω–∏–π
curl -X POST "http://localhost:8000/search" \
  -H "Content-Type: application/json" \
  -d '{
    "search_type": "semfuz",
    "database_name": "cmp",
    "top_k": 10,
    "history": [
      {"role": "user", "text": "—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è"}
    ]
  }'

# –°–æ–∑–¥–∞–Ω–∏–µ FAQ —ç–ª–µ–º–µ–Ω—Ç–∞
curl -X POST "http://localhost:8000/faq/db" \
  -H "Content-Type: application/json" \
  -d '{
    "question": "–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç?",
    "answer": "–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç MAX API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π..."
  }'
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ AI Assistant

- **sentence-transformers** - ML –º–æ–¥–µ–ª–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
  - `all-mpnet-base-v2` - –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å (768 –∏–∑–º–µ—Ä–µ–Ω–∏–π)
  - `all-MiniLM-L6-v2` - –ª–µ–≥–∫–æ–≤–µ—Å–Ω–∞—è –º–æ–¥–µ–ª—å
- **pgvector** - —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ PostgreSQL –¥–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞
- **Yandex GPT** - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- **pymorphy3** - –ª–µ–º–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
- **Levenshtein** - fuzzy –ø–æ–∏—Å–∫ –ø–æ —Å—Ç—Ä–æ–∫–∞–º

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
pip install -e .
```

### –õ–∏–Ω—Ç–∏–Ω–≥

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
pip install ruff black mypy

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
ruff check .
black --check .
mypy .
```

### –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
black .
ruff check --fix .
```

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- **–ö–æ–Ω—Å–æ–ª—å** - –≤—Å–µ —É—Ä–æ–≤–Ω–∏ (INFO –∏ –≤—ã—à–µ)
- **–§–∞–π–ª** - `logs/bot.log` (—Ä–æ—Ç–∞—Ü–∏—è –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 10MB)

–£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:
- `DEBUG` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `INFO` - –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `WARNING` - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `ERROR` - –æ—à–∏–±–∫–∏
- `CRITICAL` - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**Docker:**
```bash
docker-compose logs -f bot
```

**–õ–æ–∫–∞–ª—å–Ω–æ:**
```bash
tail -f logs/bot.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker ps
docker inspect max-bot
```

### –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

```bash
docker exec -it max-bot /bin/bash
```

## üö¶ –°—Ç–∞—Ç—É—Å—ã —Ä–∞–±–æ—Ç—ã

–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ, –∫–æ–≥–¥–∞ –≤ –ª–æ–≥–∞—Ö –ø–æ—è–≤–ª—è–µ—Ç—Å—è:

```
INFO - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
INFO - –ë–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
INFO - üöÄ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ long polling
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ** `.env` —Ñ–∞–π–ª —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** –¥–ª—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ** –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install --upgrade -r requirements.txt`
4. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø** –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ª–æ–≥–∞–º

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å:

- **Health checks** –≤ Docker Compose
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤** (ELK Stack, Grafana Loki)
- **–ú–µ—Ç—Ä–∏–∫–∏** (Prometheus + Grafana)
- **–ê–ª–µ—Ä—Ç—ã** –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

## ‚ùì FAQ

### MAX Bot

**Q: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è**
A: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏, —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ MAX_API_TOKEN –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∏ –±–æ—Ç –∑–∞–ø—É—â–µ–Ω

**Q: –û—à–∏–±–∫–∞ "Database is locked"**
A: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞ –∑–∞–ø—É—â–µ–Ω

**Q: –ö–Ω–æ–ø–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç**
A: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `flow.json` –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω –∏ –≤—Å–µ flows –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã

**Q: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π**
A: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∑–∞–ø—É—â–µ–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø—Ä–æ—Ü–µ—Å—Å –±–æ—Ç–∞

### AI Assistant

**Q: AI Assistant –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**
A: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ PostgreSQL –∑–∞–ø—É—â–µ–Ω –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ pgvector

**Q: –û—à–∏–±–∫–∞ "relation does not exist"**
A: –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏: `docker exec -it max-ai alembic upgrade head`

**Q: –ì–¥–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API?**
A: –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/docs –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ AI Assistant

**Q: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ FAQ?**
A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ API `POST /faq/db` –∏–ª–∏ –º–∞—Å—Å–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç `POST /faq/bulk_import`

**Q: AI –ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ**
A: –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –º–æ–¥–µ–ª–∏ —Å–∫–∞—á–∏–≤–∞—é—Ç—Å—è –∏ –∫—ç—à–∏—Ä—É—é—Ç—Å—è, –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–ø—É—Å–∫–∏ –±—É–¥—É—Ç –±—ã—Å—Ç—Ä–µ–µ

**Q: –ù—É–∂–µ–Ω –ª–∏ Yandex API Key?**
A: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å YandexGPT –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ (search_type="gpt")

---

**–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è MAX Platform**
